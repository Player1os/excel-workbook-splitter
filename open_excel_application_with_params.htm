<!DOCTYPE html>
<html>
	<head></head>
	<body>
		<!--
		The following script is executed on load:
		1. hides the current page.
		2. opens an excel workbook with macros.
		3. reads the query parameters in the requested url and sends
		them to a predefined sub routine within the workbook.
		-->
		<script>
			function getParameterByName(name, url) {
				if (!url) {
					url = window.location.href;
				}
				name = name.replace(/[\[\]]/g, '\\$&');
				
				var regex = new RegExp("[?&]" + name + "(=([^&#]*)|&|#|$)");
				var results = regex.exec(url);
				
				if (!results) {
					return null;
				}
				if (!results[2]) {
					return '';
				}
				return decodeURIComponent(results[2].replace(/\+/g, ' '));
			}

			window.onload = function () {
				window.onload = function () {
					window.open('', '_self', '');
					window.close();
				};
			
				var Excel = new ActiveXObject('Excel.Application');
				Excel.Visible = true;
				
				var excelWorkbook = Excel.Workbooks.Open('C:\\Projects\\MagentaOfficeMax\\ProtectionTest.xlsm');
				excelWorkbook.loadParameters(getParameterByName('hello'));
			};
		</script>
	</body>
</html>
